import{_ as C,a as m,o as n,c as d,b as o,t as l,h as P,w as g,v as c,F as p,r as f,e as u,d as j}from"./index-c433af20.js";const S={name:"CreationPersonnage",data(){return{formData:{nom:"",description:"",projetId:"",comedienId:null},projets:[],comediens:[],personnages:[],isEditing:!1,editingId:null,isSubmitting:!1,loading:!1,projetSearch:"",comedienSearch:"",showProjetSuggestions:!1,showComedienSuggestions:!1,filteredProjets:[],filteredComediens:[]}},async mounted(){await this.loadProjets(),await this.loadComediens(),await this.loadPersonnages(),this.filteredProjets=[...this.projets],this.filteredComediens=[...this.comediens]},watch:{projets:{handler(s){this.filteredProjets=[...s]},deep:!0},comediens:{handler(s){this.filteredComediens=[...s]},deep:!0}},methods:{async loadProjets(){try{const s=await m.get("/api/projets");this.projets=s.data}catch(s){console.error("Erreur lors du chargement des projets:",s),alert("Erreur lors du chargement des projets")}},async loadComediens(){try{const s=await m.get("/api/comediens");this.comediens=s.data}catch(s){console.error("Erreur lors du chargement des com√©diens:",s),alert("Erreur lors du chargement des com√©diens")}},async loadPersonnages(){this.loading=!0;try{const s=await m.get("/api/personnages");this.personnages=s.data}catch(s){console.error("Erreur lors du chargement des personnages:",s),alert("Erreur lors du chargement des personnages")}finally{this.loading=!1}},async submitForm(){var s,e;this.isSubmitting=!0;try{this.isEditing?(await m.put(`/api/personnages/${this.editingId}`,this.formData),alert("Personnage modifi√© avec succ√®s")):(await m.post("/api/personnages",this.formData),alert("Personnage cr√©√© avec succ√®s")),this.resetForm(),await this.loadPersonnages()}catch(a){console.error("Erreur lors de la sauvegarde:",a),alert("Erreur lors de la sauvegarde: "+(((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||a.message))}finally{this.isSubmitting=!1}},editPersonnage(s){this.formData={nom:s.nom,description:s.description||"",projetId:s.projetId,comedienId:s.comedienId},this.isEditing=!0,this.editingId=s.id,document.querySelector(".form-container").scrollIntoView({behavior:"smooth"})},async deletePersonnage(s){if(confirm("√ätes-vous s√ªr de vouloir supprimer ce personnage ?"))try{await m.delete(`/api/personnages/${s}`),alert("Personnage supprim√© avec succ√®s"),await this.loadPersonnages()}catch(e){console.error("Erreur lors de la suppression:",e),alert("Erreur lors de la suppression")}},resetForm(){this.formData={nom:"",description:"",projetId:"",comedienId:""},this.projetSearch="",this.comedienSearch="",this.isEditing=!1,this.editingId=null,this.filteredProjets=[...this.projets],this.filteredComediens=[...this.comediens]},formatDate(s){return new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},filterProjets(){const s=this.projetSearch.toLowerCase();if(!s){this.filteredProjets=[...this.projets];return}this.filteredProjets=this.projets.filter(e=>e.titre.toLowerCase().includes(s))},filterComediens(){const s=this.comedienSearch.toLowerCase();if(!s){this.filteredComediens=[...this.comediens];return}this.filteredComediens=this.comediens.filter(e=>e.nom.toLowerCase().includes(s)||e.age.toString().includes(s))},selectProjet(s){this.formData.projetId=s.id,this.projetSearch=s.titre,this.showProjetSuggestions=!1},selectComedien(s){this.formData.comedienId=s.id,this.comedienSearch=`${s.nom} (${s.age} ans)`,this.showComedienSuggestions=!1},clearComedien(){this.formData.comedienId=null,this.comedienSearch="",this.showComedienSuggestions=!1},hideProjetSuggestions(){setTimeout(()=>{this.showProjetSuggestions=!1},200)},hideComedienSuggestions(){setTimeout(()=>{this.showComedienSuggestions=!1},200)},getProjetName(s){const e=this.projets.find(a=>a.id===s);return e?e.titre:""},getComedienName(s){if(!s)return"";const e=this.comediens.find(a=>a.id===s);return e?`${e.nom} (${e.age} ans)`:""}}},b={class:"creation-personnage"},v={class:"form-container"},y={class:"form-group"},w={class:"form-group"},_={class:"combobox-container"},D=["placeholder"],I={key:0,class:"suggestions-list"},k=["onMousedown"],E={key:1,class:"suggestions-list"},x={class:"form-group"},F={class:"form-group"},M={class:"combobox-container"},N=["placeholder"],L={key:1,class:"suggestions-list"},V=["onMousedown"],T={key:2,class:"suggestions-list"},B={class:"form-actions"},A=["disabled"],U={class:"personnages-list"},q={key:0,class:"loading"},R={key:1,class:"empty-state"},z={key:2,class:"personnages-grid"},G={class:"personnage-header"},H={class:"actions"},J=["onClick"],K=["onClick"],O={class:"personnage-details"},Q={key:0},W={class:"date-info"};function X(s,e,a,Y,r,i){return n(),d("div",b,[e[23]||(e[23]=o("h2",null,"Cr√©ation et Gestion des Personnages",-1)),o("div",v,[o("h3",null,l(r.isEditing?"Modifier":"Cr√©er")+" un personnage",1),o("form",{onSubmit:e[12]||(e[12]=P((...t)=>i.submitForm&&i.submitForm(...t),["prevent"])),class:"personnage-form"},[o("div",y,[e[13]||(e[13]=o("label",{for:"nom"},"Nom du personnage *",-1)),g(o("input",{type:"text",id:"nom","onUpdate:modelValue":e[0]||(e[0]=t=>r.formData.nom=t),required:"",placeholder:"Entrez le nom du personnage"},null,512),[[c,r.formData.nom]])]),o("div",w,[e[15]||(e[15]=o("label",{for:"projet"},"Projet *",-1)),o("div",_,[g(o("input",{type:"text",id:"projet","onUpdate:modelValue":e[1]||(e[1]=t=>r.projetSearch=t),onFocus:e[2]||(e[2]=t=>r.showProjetSuggestions=!0),onBlur:e[3]||(e[3]=(...t)=>i.hideProjetSuggestions&&i.hideProjetSuggestions(...t)),onInput:e[4]||(e[4]=(...t)=>i.filterProjets&&i.filterProjets(...t)),placeholder:r.formData.projetId?i.getProjetName(r.formData.projetId):"Rechercher un projet...",required:"",class:"combobox-input"},null,40,D),[[c,r.projetSearch]]),r.showProjetSuggestions&&r.filteredProjets.length?(n(),d("ul",I,[(n(!0),d(p,null,f(r.filteredProjets,t=>(n(),d("li",{key:t.id,onMousedown:h=>i.selectProjet(t),class:"suggestion-item"},l(t.titre),41,k))),128))])):u("",!0),r.showProjetSuggestions&&r.filteredProjets.length===0?(n(),d("ul",E,[...e[14]||(e[14]=[o("li",{class:"suggestion-item no-results"},"Aucun projet trouv√©",-1)])])):u("",!0)])]),o("div",x,[e[16]||(e[16]=o("label",{for:"description"},"Description",-1)),g(o("textarea",{id:"description","onUpdate:modelValue":e[5]||(e[5]=t=>r.formData.description=t),rows:"4",placeholder:"D√©crivez le personnage..."},null,512),[[c,r.formData.description]])]),o("div",F,[e[18]||(e[18]=o("label",{for:"comedien"},"Com√©dien",-1)),o("div",M,[g(o("input",{type:"text",id:"comedien","onUpdate:modelValue":e[6]||(e[6]=t=>r.comedienSearch=t),onFocus:e[7]||(e[7]=t=>r.showComedienSuggestions=!0),onBlur:e[8]||(e[8]=(...t)=>i.hideComedienSuggestions&&i.hideComedienSuggestions(...t)),onInput:e[9]||(e[9]=(...t)=>i.filterComediens&&i.filterComediens(...t)),placeholder:r.formData.comedienId?i.getComedienName(r.formData.comedienId):"Rechercher un com√©dien (optionnel)...",class:"combobox-input"},null,40,N),[[c,r.comedienSearch]]),r.formData.comedienId?(n(),d("button",{key:0,type:"button",onClick:e[10]||(e[10]=(...t)=>i.clearComedien&&i.clearComedien(...t)),class:"clear-button",title:"Supprimer le com√©dien"}," √ó ")):u("",!0),r.showComedienSuggestions&&r.filteredComediens.length?(n(),d("ul",L,[(n(!0),d(p,null,f(r.filteredComediens,t=>(n(),d("li",{key:t.id,onMousedown:h=>i.selectComedien(t),class:"suggestion-item"},l(t.nom)+" ("+l(t.age)+" ans) ",41,V))),128))])):u("",!0),r.showComedienSuggestions&&r.filteredComediens.length===0?(n(),d("ul",T,[...e[17]||(e[17]=[o("li",{class:"suggestion-item no-results"},"Aucun com√©dien trouv√©",-1)])])):u("",!0)])]),o("div",B,[o("button",{type:"submit",disabled:r.isSubmitting,class:"btn-primary"},l(r.isEditing?"Modifier":"Cr√©er")+" le personnage ",9,A),r.isEditing?(n(),d("button",{key:0,type:"button",onClick:e[11]||(e[11]=(...t)=>i.resetForm&&i.resetForm(...t)),class:"btn-secondary"}," Annuler ")):u("",!0)])],32)]),o("div",U,[e[22]||(e[22]=o("h3",null,"Liste des personnages",-1)),r.loading?(n(),d("div",q,"Chargement...")):r.personnages.length===0?(n(),d("div",R," Aucun personnage cr√©√© pour le moment. ")):(n(),d("div",z,[(n(!0),d(p,null,f(r.personnages,t=>(n(),d("div",{key:t.id,class:"personnage-card"},[o("div",G,[o("h4",null,l(t.nom),1),o("div",H,[o("button",{onClick:h=>i.editPersonnage(t),class:"btn-edit",title:"Modifier"}," ‚úèÔ∏è ",8,J),o("button",{onClick:h=>i.deletePersonnage(t.id),class:"btn-delete",title:"Supprimer"}," üóëÔ∏è ",8,K)])]),o("div",O,[o("p",null,[e[19]||(e[19]=o("strong",null,"Projet:",-1)),j(" "+l(t.projetTitre),1)]),o("p",null,[e[20]||(e[20]=o("strong",null,"Com√©dien:",-1)),j(" "+l(t.comedienNom),1)]),t.description?(n(),d("p",Q,[e[21]||(e[21]=o("strong",null,"Description:",-1)),j(" "+l(t.description),1)])):u("",!0),o("p",W," Cr√©√© le: "+l(i.formatDate(t.creeLe)),1)])]))),128))]))])])}const $=C(S,[["render",X],["__scopeId","data-v-fb9daabd"]]);export{$ as default};
